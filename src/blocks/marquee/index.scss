/**
 * Block: Marquee - Frontend Styles
 *
 * Frontend specific styles for the Marquee block. Handles scrolling animations,
 * responsive behavior, and visual effects for continuously moving content.
 *
 * @file        blocks/marquee/index.scss
 * @package     OrbiTools
 * @subpackage  orbitools/blocks
 * @author      OrbiTools Team
 * @since       1.0.0
 * @version     1.0.0
 *
 * @see         blocks/marquee/editor.scss - Editor styles
 */

// Base class for Marquee block
$elem_base: 'orb-marquee';

.#{$elem_base} {
    position: relative;
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    padding: 0;

    &[data-marquee-initialized="true"] {
        .#{$elem_base}__content {
            opacity: 1;
        }
    }

    &.alignfull:not(.has-spacing) {
        .#{$elem_base}__wrapper {
            margin-left: calc(var(--gutter-page) * -1);
            margin-right: calc(var(--gutter-page) * -1);
            min-width: calc(100% + calc(var(--gutter-page) * 2));
        }
    }
    // =======================
    // Core Animation Setup
    // =======================

    // Wrapper contains the scrolling content
    &__wrapper {
        display: flex;

        width: max-content;
        min-width: 100%;
    }

    // Content container - holds the actual inner blocks
    &__content {
        display: flex;
        align-items: center;
        gap: var(--marquee-gap, 40px);
        flex-shrink: 0;
        opacity: 0;
    }

    // =======================
    // Overlay Effects
    // =======================

    &__overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        pointer-events: none;
        z-index: 1;
    }

    &.has-overlay-color {
        .#{$elem_base}__overlay {
            background: linear-gradient(
                90deg,
                var(--marquee-overlay-color, transparent) 0%,
                transparent 10%,
                transparent 90%,
                var(--marquee-overlay-color, transparent) 100%
            );
        }

        // Vertical overlay gradient
        &.#{$elem_base}--y .#{$elem_base}__overlay {
            background: linear-gradient(
                180deg,
                var(--marquee-overlay-color, transparent) 0%,
                transparent 10%,
                transparent 90%,
                var(--marquee-overlay-color, transparent) 100%
            );
        }
    }
}

// =======================
// Accessibility
// =======================

// High contrast mode support
@media (prefers-contrast: high) {
    .#{$elem_base} {
        &.has-overlay-color .#{$elem_base}__overlay {
            display: none; // Remove overlay in high contrast
        }
    }
}

// =======================
// Editor-specific Overrides
// =======================

.block-editor-block-preview__content {
    .#{$elem_base} {
        // Slower animation in editor preview
        &__wrapper {
            animation-duration: calc(var(--marquee-speed, 10s) * 2);
        }
    }
}

// =======================
// Theme Integration
// =======================

// Support for theme colors
.has-text-color .#{$elem_base} {
    &__content {
        color: inherit;
    }
}

.has-background .#{$elem_base} {
    background: inherit;
}

// =======================
// Performance Optimizations
// =======================

.#{$elem_base} {
    // Contain layout shifts
    contain: layout style;

    // Hardware acceleration
    &__wrapper {
        will-change: transform;
        transform: translateZ(0); // Force GPU acceleration
    }
}

// =======================
// Error States
// =======================

// When content is too short for proper marquee effect
.#{$elem_base}--insufficient-content {
    .#{$elem_base}__wrapper {
        animation: none;
        justify-content: center;
    }
}
